// ???? ifdef ?????????? DLL ?????????
// ?????????????? DLL ????????????????????????????? LIBHTTP_EXPORTS
// ??????????????“? DLL ??
// ????????????????????????????????????????????????????????????
// LIBHTTP_API ?????????? DLL ??????????? DLL ?????“??????
// ?????????????????
#ifdef WIN32
#ifdef LIBHTTP_EXPORTS
#define LIBHTTP_API __declspec(dllexport)
#else
#define LIBHTTP_API __declspec(dllimport)
#endif
#else
#define LIBHTTP_API
#endif

#include "json/value.h"

#define MAX_POSTID        100                 //post id ????

//ERROR CODE
#define	LIBERROR_OK          0					 //???
#define	LIBERROR_OTHER       2001                //???????
#define LIBERROR_PARAM       2002                //????????
#define	LIBERROR_RIGIST_URL            2003      //?????url
#define LIBERROR_ID_FINISHED           2004      //ID???
#define LIBERROR_ID_NOTFIND            2005      //IDë???
#define LIBERROR_JSON_EXCEPTION        2006      //json??


#ifdef _WIN32
#ifndef CALLBACK
#define CALLBACK __stdcall
#endif
#else
#define CALLBACK
#endif

/* ????? POST?????
** ??????
**       url,url???
**       result,0???,??????????
**       value, ????json????
**       userData,?–?????
** ???????
**       ??
*/
typedef void (CALLBACK *ResponseCB)(const char* url, int result, const Json::Value& value, void* userData);

/* ????? POST?????
** ??????
**       url,url???
**       result,0???,??????????
**       json, ????json?????
**       jsonLen, ????json?????????
**       userData,?–?????
** ???????
**       ??
*/
typedef void (CALLBACK *ResponseCBEx)(const char* url, int result, const char* json, int jsonLen, void* userData);

#ifdef __cplusplus
extern "C"
{
#endif

        /* ??????????
        ** ??????
        **      caPath ??CA???ú????[IN]
        ** ???????
        **      0,?????????????????
        */
        LIBHTTP_API int LIBInit(const char* caPath);

        /* ????????????
        ** ???????
        **      0,?????????????????
        */
        LIBHTTP_API int LIBUnInit();

        /* ????? ????HTTP?
        ** ??????
        **       url,   url???,   [IN]
        **       header,HTTP????,[IN]
        ** ???????
        **       0??????? ????????????
        ** ????? ??????????Content-Type ??apiId ??apiKey??timestamp??sign?????????????????????????????????????
        */
        LIBHTTP_API int LIBSetHeader(const char* url, const Json::Value& header);

        /* ????? ????HTTP?
        ** ??????
        **       url,   url???,   [IN]
        **       header,HTTP????json?????,[IN]
        ** ???????
        **       0??????? ????????????
        ** ????? ??????????Content-Type ??apiId ??apiKey??timestamp??sign?????????????????????????????????????
        */
        LIBHTTP_API int LIBSetHeaderEx(const char* url, const char* header);


        /* ????? ???HTTP?????
        ** ??????
        **      url,  url???,   [IN]
        ** ???????
        **      0???????????????????
        */
        LIBHTTP_API int LIBRemoveHeader(const char* url);

        /* ????? ????????????
        ** ??????
        **      cb, ???????, [IN]
        **      userData, ?–?????? [IN]
        ** ???????
        **      0???????????????????
        */
        LIBHTTP_API int LIBSetResponseCB(ResponseCB cb, void* userData);

        /* ????? ????????????
        ** ??????
        **      cb, ???????, [IN]
        **      userData, ?–?????? [IN]
        ** ???????
        **      0???????????????????
        */
        LIBHTTP_API int LIBSetResponseCBEx(ResponseCBEx cb, void* userData);

        /* ????? POST??
        ** ??????
        **      ipAddr, ip???, [IN]		   https://192.168.1.105:4433/security-server
        **      apiAddr, ???????[IN]	   /api/v1/face/security/manual-check
        **      body, ????????json?????? [IN]
        **      https, ??????https,[IN]
        ** ???????
        **      0???????????????????
        */
        LIBHTTP_API int LIBPost(const char* ipAddr, const char* apiAddr, const Json::Value& body, bool https);

        /* ????? POST??
        ** ??????
        **      ipAddr, ip???, [IN]		   https://192.168.1.105:4433/security-server
        **      apiAddr, ???????[IN]	   /api/v1/face/security/manual-check
        **      body, ????????json??????? [IN]
        **      https, ??????https,[IN]
        ** ???????
        **      0???????????????????
        */
        LIBHTTP_API int LIBPostEx(const char* ipAddr, const char* apiAddr, const char* body, bool https);

        /* ????? POST???
        ** ??????
        **      ipAddr, ip???, [IN]		   https://192.168.1.105:4433/security-server
        **      apiAddr, ???????[IN]	   /api/v1/face/security/manual-check
        **      body, ????????json?????? [IN]
        **      response?? ??????????json?????? [OUT]
        **      https, ??????https,[IN]
        ** ???????
        **      0???????????????????
        */
        LIBHTTP_API int LIBPostSyn(const char* ipAddr, const char* apiAddr, const Json::Value& body, Json::Value& response, bool https);

        /* ????? POST???
        ** ??????
        **		ipAddr, ip???, [IN]		   https://192.168.1.105:4433/security-server
        **      apiAddr, ???????[IN]	   /api/v1/face/security/manual-check
        **      body, ????????json??????? [IN]
        **      response?? ??????????json??????? [OUT]
        **      resLen, ??????????json?????????, [OUT]
        **      https, ??????https,[IN]
        ** ???????
        **      0???????????????????
        */
        LIBHTTP_API int LIBPostSynEx(const char* ipAddr, const char* apiAddr, const char* body, char** response, int* resLen, bool https);

        /* ????? MD5????
        ** ??????
        **      src??????????[IN]
        **      dst, ????????????[OUT]
        **      dstLen, ???????????????[OUT]
        ** ???????
        **      0???????????????????
        */
        LIBHTTP_API int LIBMD5Encode(const char* src, char** dst, int* dstLen);

        /* ?????Base64????
        ** ??????
        **      src, ??????[IN]
        **      len, ????????,[IN]
        **      dst, base64???????[OUT]
        **      dstLen, ???????????????[OUT]
        ** ???????
        **      0???????????????????
        */
        LIBHTTP_API int LIBBase64Encode(const char* src, int len, char** dst, int* dstLen);

        /* ?????Base64????
        ** ??????
        **      src, base64?????[IN]
        **      dst, ??????????,[OUT]
        **      len, ????????[OUT]
        ** ???????
        **      0???????????????????
        */
        LIBHTTP_API int LIBBase64Decode(const char* src, char** dst, int* len);


#ifdef __cplusplus
}
#endif
